{% extends "main/base.html" %}
{% block title %}RagaSpace — Profile{% endblock %}
{% block content %}
<section class="container" style="padding:48px 0; display:grid; gap:32px;">
  <div class="intro" style="flex-wrap:wrap;">
    <div class="copy">
      <h2>Welcome back, {{ request.user.first_name|default:request.user.username }}</h2>
      <p>Keep track of your bookings, wishlist, and reviews from one curated dashboard.</p>
    </div>
    <div style="display:flex; gap:16px; flex-wrap:wrap;">
      <div style="min-width:160px; background:rgba(7,27,32,.6); border:1px solid var(--stroke); border-radius:16px; padding:14px 18px;">
        <div style="font-size:12px; color:var(--muted);">Wishlist</div>
        <div style="font-size:28px; font-weight:700;">{{ wishlist_count }}</div>
      </div>
      <div style="min-width:160px; background:rgba(7,27,32,.6); border:1px solid var(--stroke); border-radius:16px; padding:14px 18px;">
        <div style="font-size:12px; color:var(--muted);">Reviews</div>
        <div style="font-size:28px; font-weight:700;">{{ review_count }}</div>
      </div>
    </div>
  </div>
  <div style="display:grid; gap:24px; grid-template-columns:repeat(auto-fit, minmax(320px, 1fr));">
    <div style="background:rgba(7,27,32,.65); border:1px solid var(--stroke); border-radius:18px; padding:22px; display:grid; gap:16px;">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <h3 style="margin:0;">Upcoming bookings</h3>
        <span style="font-size:12px; color:var(--muted);">{{ upcoming_bookings|length }} scheduled</span>
      </div>
      {% if upcoming_bookings %}
        <ul style="margin:0; padding:0; list-style:none; display:grid; gap:14px;">
          {% for booking in upcoming_bookings %}
            <li style="border:1px solid var(--stroke); border-radius:14px; padding:14px; background:rgba(8,33,38,.65);">
              <div style="display:flex; justify-content:space-between; gap:12px;">
                <div>
                  <strong>{{ booking.venue.name }}</strong>
                  <div style="font-size:13px; color:var(--muted);">{{ booking.date }} • {{ booking.start_time }} - {{ booking.end_time }}</div>
                </div>
                <span style="font-size:12px; color:var(--accent); font-weight:600;">{{ booking.get_status_display }}</span>
              </div>
              <a class="link" href="{{ booking.venue.get_absolute_url }}" style="margin-top:10px; display:inline-block;">View details</a>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p style="color:var(--muted);">No upcoming bookings yet. Reserve your next matchday now.</p>
      {% endif %}
    </div>
    <div style="background:rgba(7,27,32,.65); border:1px solid var(--stroke); border-radius:18px; padding:22px; display:grid; gap:16px;">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <h3 style="margin:0;">Previous sessions</h3>
        <span style="font-size:12px; color:var(--muted);">{{ past_bookings|length }} played</span>
      </div>
      {% if past_bookings %}
        <ul style="margin:0; padding:0; list-style:none; display:grid; gap:14px; max-height:360px; overflow:auto;">
          {% for booking in past_bookings %}
            <li style="border:1px solid var(--stroke); border-radius:14px; padding:14px; background:rgba(8,33,38,.45);">
              <div style="display:flex; justify-content:space-between; gap:12px;">
                <div>
                  <strong>{{ booking.venue.name }}</strong>
                  <div style="font-size:13px; color:var(--muted);">{{ booking.date }} • {{ booking.start_time }} - {{ booking.end_time }}</div>
                </div>
                <span style="font-size:12px; color:var(--muted);">{{ booking.get_status_display }}</span>
              </div>
              <a class="link" href="{{ booking.venue.get_absolute_url }}" style="margin-top:10px; display:inline-block;">Book again</a>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p style="color:var(--muted);">Once you play at a RagaSpace venue, your history will show here for easy rebooking.</p>
      {% endif %}
    </div>
  </div>
</section>
{% endblock %}
