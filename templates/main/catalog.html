{% extends "main/base.html" %}
{% block title %}RagaSpace — Catalog{% endblock %}
{% block content %}
<section class="container" style="padding-top:48px;">
  <div class="intro" style="justify-content:space-between; align-items:flex-end; flex-wrap:wrap; gap:24px;">
    <div class="copy">
      <h2>Explore our full venue catalog</h2>
      <p>Select by city, sport, or budget to uncover spaces tailored to your squad.</p>
    </div>
    <form method="get" action="" style="display:flex; gap:12px; flex-wrap:wrap; align-items:center;">
      <div class="pill" style="flex:1 1 220px;">
        <div style="display:flex; flex-direction:column; gap:4px; width:100%;">
          <span style="font-size:12px; color:var(--muted);">Search</span>
          {{ filter_form.q }}
        </div>
      </div>
      <div class="pill" style="flex:1 1 160px;">
        <div style="display:flex; flex-direction:column; gap:4px; width:100%;">
          <span style="font-size:12px; color:var(--muted);">City</span>
          {{ filter_form.city }}
        </div>
      </div>
      <div class="pill" style="flex:1 1 160px;">
        <div style="display:flex; flex-direction:column; gap:4px; width:100%;">
          <span style="font-size:12px; color:var(--muted);">Category</span>
          {{ filter_form.category }}
        </div>
      </div>
      <div class="pill" style="flex:1 1 160px;">
        <div style="display:flex; flex-direction:column; gap:4px; width:100%;">
          <span style="font-size:12px; color:var(--muted);">Max Price</span>
          {{ filter_form.max_price }}
        </div>
      </div>
      <button class="btn" type="submit" style="height:48px;">Filter</button>
    </form>
  </div>
  <div class="grid" style="margin-top:36px;">
    {% for venue in venues %}
      <article class="card">
        <div class="card-media">
          <span class="cat">{{ venue.category.name }}</span>
          <img src="{{ venue.hero_image }}" alt="{{ venue.name }}" />
          <form method="post" action="{% url 'toggle_wishlist' venue.slug %}" class="heart">
            {% csrf_token %}
            <input type="hidden" name="next" value="{{ request.get_full_path }}" />
            <button type="submit" aria-label="Toggle wishlist" style="all:unset; display:grid; place-items:center;">
              <svg width="20" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 21s-6.5-4.35-9-8.88C1.5 6.6 4.74 3 8.4 3c2.16 0 3.6 1.34 3.6 1.34S13.44 3 15.6 3C19.26 3 22.5 6.6 21 12.12 18.5 16.65 12 21 12 21Z" fill="{% if venue.id in wishlist_ids %}#ff5d6c{% else %}none{% endif %}" stroke="#ff5d6c" stroke-width="1.4" />
              </svg>
            </button>
          </form>
        </div>
        <div class="card-body">
          <h3>{{ venue.name }}</h3>
          <div class="meta">
            <span>{{ venue.city }}</span>
            <span>•</span>
            <span>{{ venue.capacity }} people</span>
          </div>
          <p style="color:var(--muted); font-size:13px; min-height:54px;">{{ venue.description|truncatewords:20 }}</p>
          <div class="price">
            <span class="tag">IDR {{ venue.price_per_hour|floatformat:0 }}/hour</span>
            <a class="link" href="{{ venue.get_absolute_url }}">View Product</a>
          </div>
        </div>
      </article>
    {% empty %}
      <p>No venues match your filters yet. Try broadening your search.</p>
    {% endfor %}
  </div>
</section>
{% endblock %}
{% block extra_scripts %}
  {{ block.super }}
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.pill input, .pill select').forEach((field) => {
        field.style.background = 'transparent';
        field.style.border = 'none';
        field.style.color = 'var(--text)';
        field.style.fontWeight = '600';
      });
    });
  </script>
{% endblock %}
